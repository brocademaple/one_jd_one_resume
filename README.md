# æ±‚èŒ Agent

ä¸€ä¸ªæ”¯æŒå¤šæ¨¡å‹çš„æ™ºèƒ½æ±‚èŒç³»ç»Ÿï¼Œå¸®åŠ©ç”¨æˆ·æ ¹æ®å²—ä½ JD ç”Ÿæˆä¸“ä¸šå®šåˆ¶ç®€å†ï¼Œå¹¶æä¾›é¢è¯•è¾…å¯¼ã€‚

## åŠŸèƒ½ç‰¹æ€§

- **JD ç®¡ç†** â€” æ–°å»ºã€ç¼–è¾‘ã€åˆ é™¤å²—ä½æè¿°
- **ç®€å†å®šåˆ¶** â€” AI Agent æ ¹æ® JD å’Œä¸ªäººç»å†ç”Ÿæˆå®šåˆ¶ç®€å†
- **å¯¹è¯å¼äº¤äº’** â€” é€šè¿‡è‡ªç„¶è¯­è¨€å¯¹è¯ä¸æ–­ä¼˜åŒ–ç®€å†
- **é¢è¯•è¾…å¯¼** â€” æä¾›é’ˆå¯¹æ€§çš„é¢è¯•æŠ€å·§å’Œå¸¸è§é—®é¢˜è§£ç­”
- **ç®€å†å¯¼å‡º** â€” æ”¯æŒ PDF å’Œ Word æ ¼å¼å¯¼å‡ºï¼Œå¹¶å¯æ”¾å¤§é¢„è§ˆ
- **æ–‡ä»¶ç®¡ç†** â€” ç®¡ç†å¤šä¸ªå²—ä½å¯¹åº”çš„å¤šç‰ˆæœ¬ç®€å†
- **å¤šæ¨¡å‹æ”¯æŒ** â€” å¯åˆ‡æ¢ Claude / é€šä¹‰åƒé—® / æ™ºè°± / DeepSeek / Kimi / æ–‡å¿ƒ

---

## ç•Œé¢å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ç®€å†å®šåˆ¶ Agent                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          â”‚                   â”‚                   â”‚                    â”‚
â”‚  ä¾§è¾¹æ   â”‚    å²—ä½ JD é¢æ¿   â”‚   ç®€å†å†…å®¹é¢æ¿    â”‚   Agent å¯¹è¯é¢æ¿   â”‚
â”‚          â”‚                   â”‚                   â”‚                    â”‚
â”‚ â–¸ å²—ä½A  â”‚  # é«˜çº§å‰ç«¯å·¥ç¨‹å¸ˆ â”‚  # å¼ ä¸‰           â”‚  ğŸ¤– æˆ‘æ˜¯ç®€å†å®šåˆ¶   â”‚
â”‚   â””ç®€å†1 â”‚                   â”‚  ---              â”‚     åŠ©æ‰‹...        â”‚
â”‚   â””ç®€å†2 â”‚  ## å²—ä½è¦æ±‚      â”‚  ## å·¥ä½œç»å†      â”‚                    â”‚
â”‚ â–¸ å²—ä½B  â”‚  - React 3å¹´ä»¥ä¸Š  â”‚  å­—èŠ‚è·³åŠ¨ 2021-   â”‚  ğŸ‘¤ å¸®æˆ‘ç”Ÿæˆç®€å†   â”‚
â”‚   â””ç®€å†1 â”‚  - ç†Ÿæ‚‰æ€§èƒ½ä¼˜åŒ–   â”‚  è´Ÿè´£...          â”‚                    â”‚
â”‚          â”‚                   â”‚                   â”‚  ğŸ¤– å¥½çš„ï¼Œæ ¹æ®     â”‚
â”‚ [æ–°å»º]   â”‚  ## è–ªèµ„          â”‚  ## æ•™è‚²èƒŒæ™¯      â”‚     æ‚¨çš„JD...      â”‚
â”‚          â”‚  25-40K           â”‚  æ¸…åå¤§å­¦ 2018    â”‚                    â”‚
â”‚ âš™ æ¨¡å‹  â”‚                   â”‚                   â”‚  [å¯¼å‡ºPDF] [.md]   â”‚
â”‚ DeepSeek â”‚  [ç¼–è¾‘]           â”‚  [ç¼–è¾‘] [å¯¼å‡ºâ–¾]   â”‚  _______________   â”‚
â”‚          â”‚                   â”‚                   â”‚  > å‘é€æ¶ˆæ¯...  â¤  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Browser / æµè§ˆå™¨                          â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Sidebar  â”‚  â”‚  JD Panel  â”‚  â”‚Resume Panelâ”‚  â”‚Chat Panel â”‚  â”‚
â”‚  â”‚ React    â”‚  â”‚  React     â”‚  â”‚  React     â”‚  â”‚  React    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                         React + TypeScript + Tailwind           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚  REST API / SSE æµå¼
                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     FastAPI Backend                             â”‚
â”‚                                                                 â”‚
â”‚  /api/jobs â”€â”€â–º JobsRouter      â”€â”€â–º SQLAlchemy ORM              â”‚
â”‚  /api/resumes â–º ResumesRouter  â”€â”€â–º SQLAlchemy ORM              â”‚
â”‚  /api/chat â”€â”€â–º ChatRouter      â”€â”€â–º providers.py                â”‚
â”‚  /api/export â–º ExportRouter    â”€â”€â–º ReportLab PDF               â”‚
â”‚  /api/settingsâ–º SettingsRouter â”€â”€â–º ai_settings.json            â”‚
â”‚                                                                 â”‚
â”‚                 providers.py (ç»Ÿä¸€æŠ½è±¡å±‚)                        â”‚
â”‚                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚                 â”‚  Anthropic SDK   â”‚  OpenAI-compat SDK    â”‚   â”‚
â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                           â”‚
              â–¼                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   SQLite æ•°æ®åº“      â”‚     â”‚         AI æä¾›å•†                    â”‚
â”‚                     â”‚     â”‚                                     â”‚
â”‚  jobs               â”‚     â”‚  â˜ Anthropic  claude-opus-4-6      â”‚
â”‚  resumes            â”‚     â”‚  â˜ é˜¿é‡Œäº‘     qwen-max / plus       â”‚
â”‚  conversations      â”‚     â”‚  â˜ æ™ºè°±       glm-4-plus / flash    â”‚
â”‚  (ai_settings.json) â”‚     â”‚  â˜ DeepSeek   deepseek-chat / r1    â”‚
â”‚                     â”‚     â”‚  â˜ Moonshot   kimi-128k             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  â˜ ç™¾åº¦       ernie-4.0            â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æ ¸å¿ƒæ•°æ®æµ

```
ç”¨æˆ·è¾“å…¥æ¶ˆæ¯
     â”‚
     â–¼
ChatPanel.tsx
     â”‚ POST /api/chat/stream
     â”‚ { job_id, resume_id, messages[], user_background }
     â–¼
ChatRouter (FastAPI)
     â”‚ ä» DB å– Job.content + Resume.content
     â”‚ æ‹¼æ¥ System Prompt + JDä¸Šä¸‹æ–‡ + ç®€å†ä¸Šä¸‹æ–‡
     â–¼
providers.stream_response()
     â”‚ è¯»å– ai_settings.json â†’ ç¡®å®š provider + model + api_key
     â”‚
     â”œâ”€ provider=anthropic â†’ AsyncAnthropic.messages.stream()
     â””â”€ provider=å…¶ä»–     â†’ AsyncOpenAI(base_url=...).chat.completions.create(stream=True)
     â”‚
     â–¼ Server-Sent Events (text/event-stream)
     â”‚ data: {"type":"text","content":"..."}  â† é€ token æ¨é€
     â”‚ data: {"type":"done"}
     â–¼
ChatPanel.tsx (é€å­—æ¸²æŸ“)
     â”‚
     â”‚ æ£€æµ‹ ===RESUME_START=== ... ===RESUME_END=== æ ‡è®°
     â”‚
     â”œâ”€ æ— ç®€å†æ ‡è®° â†’ ä»…å±•ç¤ºå¯¹è¯å†…å®¹
     â””â”€ æœ‰ç®€å†æ ‡è®° â†’ PUT /api/resumes/{id}  æ›´æ–° DB
                         â”‚
                         â–¼
                   ResumePanel å®æ—¶åˆ·æ–°
```

---

## Agent Prompt è¯´æ˜

System Prompt å­˜æ”¾äºï¼š

```
backend/routers/chat.py
â””â”€â”€ SYSTEM_PROMPT  (ç¬¬ 13 è¡Œèµ·)
```

æ¯æ¬¡å¯¹è¯æ—¶ï¼Œåç«¯åŠ¨æ€å°†ä»¥ä¸‹å†…å®¹æ‹¼æ¥åå‘é€ç»™æ¨¡å‹ï¼š

```
[SYSTEM_PROMPT]          â† è§’è‰²å®šä¹‰ã€è¾“å‡ºæ ¼å¼è§„èŒƒ
---
## ç›®æ ‡å²—ä½JD            â† å½“å‰é€‰ä¸­å²—ä½çš„ content å­—æ®µ
{job.content}
---
## å½“å‰ç®€å†å†…å®¹           â† å½“å‰é€‰ä¸­ç®€å†çš„ contentï¼ˆå¯ä¸ºç©ºï¼‰
{resume.content}
---
## ç”¨æˆ·è¡¥å……çš„ä¸ªäººç»å†     â† å‰ç«¯ã€Œæˆ‘çš„èƒŒæ™¯ã€è¾“å…¥æ¡†å†…å®¹ï¼ˆå¯é€‰ï¼‰
{user_background}
```

---

## æŠ€æœ¯æ ˆ

- **åç«¯**: Python + FastAPI + SQLite (SQLAlchemy ORM)
- **å‰ç«¯**: React 18 + TypeScript + Tailwind CSS + Vite
- **AI å¤šæ¨¡å‹**: `anthropic` SDK + `openai` SDK (OpenAI-compat)
- **PDF å¯¼å‡º**: ReportLab

---

## æ”¯æŒçš„ AI æä¾›å•†

| æä¾›å•† | æ¨èæ¨¡å‹ | è·å– Key |
|--------|----------|----------|
| Anthropic Claude | claude-opus-4-6 | console.anthropic.com |
| é€šä¹‰åƒé—® (Qwen) | qwen-plus / qwen-max | bailian.console.aliyun.com |
| æ™ºè°± GLM | glm-4-flash (å…è´¹) / glm-4-plus | open.bigmodel.cn |
| DeepSeek | deepseek-chat / deepseek-reasoner | platform.deepseek.com |
| Moonshot (Kimi) | moonshot-v1-128k | platform.moonshot.cn |
| ç™¾åº¦æ–‡å¿ƒ (ERNIE) | ernie-4.0-turbo-8k | console.bce.baidu.com |

---

## å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
# åç«¯
cd backend && pip install -r requirements.txt

# å‰ç«¯
cd frontend && npm install
```

### 2. é…ç½® API Key

**æ–¹å¼ä¸€ï¼šé€šè¿‡ UI è®¾ç½®ï¼ˆæ¨èï¼‰**
å¯åŠ¨åç‚¹å‡»å·¦ä¸‹è§’æ¨¡å‹åç§°ï¼Œåœ¨å¼¹çª—ä¸­å¡«å†™å¯¹åº” API Keyã€‚

**æ–¹å¼äºŒï¼šç¯å¢ƒå˜é‡**

```bash
export ANTHROPIC_API_KEY=sk-ant-...
export DASHSCOPE_API_KEY=sk-...       # é€šä¹‰åƒé—®
export ZHIPU_API_KEY=...              # æ™ºè°±
export DEEPSEEK_API_KEY=sk-...        # DeepSeek
export MOONSHOT_API_KEY=sk-...        # Kimi
export QIANFAN_API_KEY=...            # ç™¾åº¦æ–‡å¿ƒ
```

### 3. å¯åŠ¨

```bash
# å¼€å‘æ¨¡å¼ï¼ˆå‰åç«¯çƒ­é‡è½½ï¼‰
chmod +x dev.sh && ./dev.sh

# ç”Ÿäº§æ¨¡å¼ï¼ˆæ„å»ºå‰ç«¯åå¯åŠ¨ï¼‰
chmod +x start.sh && ./start.sh
```

- å¼€å‘æ¨¡å¼: http://localhost:5173
- ç”Ÿäº§æ¨¡å¼: http://localhost:8000

---

## ä½¿ç”¨æ–¹æ³•

1. **æ–°å»ºå²—ä½** â€” ç‚¹å‡»å·¦ä¾§ã€Œæ–°å»ºå²—ä½ã€ï¼Œç²˜è´´å²—ä½ JD
2. **å¡«å†™èƒŒæ™¯** â€” å¯¹è¯é¢æ¿ç‚¹å‡»ã€Œæˆ‘çš„èƒŒæ™¯ã€æµ®çª—ï¼Œæ”¯æŒæ–‡æœ¬/PDF/Word/å›¾ç‰‡ OCR ä¸Šä¼ 
3. **ç”Ÿæˆç®€å†** â€” å‘é€ã€Œå¸®æˆ‘ç”Ÿæˆä¸€ä»½é’ˆå¯¹è¯¥ JD çš„ç®€å†ã€
4. **ä¼˜åŒ–è¿­ä»£** â€” ç»§ç»­å¯¹è¯ï¼Œè¦æ±‚ Agent è°ƒæ•´å…·ä½“å†…å®¹
5. **é¢è¯•è¾…å¯¼** â€” å‘é€ã€Œç»™æˆ‘é’ˆå¯¹è¯¥å²—ä½çš„é¢è¯•æŠ€å·§ã€
6. **å¯¼å‡ºç®€å†** â€” ç®€å†é¢æ¿å³ä¸Šè§’ã€Œå¯¼å‡ºã€â†’ é€‰æ‹© PDF æˆ– Markdown

---

## API æ¥å£

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| GET | /api/jobs | è·å–æ‰€æœ‰å²—ä½ |
| POST | /api/jobs | åˆ›å»ºå²—ä½ |
| PUT | /api/jobs/{id} | æ›´æ–°å²—ä½ |
| DELETE | /api/jobs/{id} | åˆ é™¤å²—ä½ |
| GET | /api/resumes | è·å–ç®€å†åˆ—è¡¨ |
| POST | /api/resumes | åˆ›å»ºç®€å† |
| PUT | /api/resumes/{id} | æ›´æ–°ç®€å† |
| DELETE | /api/resumes/{id} | åˆ é™¤ç®€å† |
| POST | /api/chat/stream | SSE æµå¼å¯¹è¯ |
| GET | /api/chat/current-provider | å½“å‰æ¨¡å‹ä¿¡æ¯ |
| GET | /api/settings | è·å–æ¨¡å‹è®¾ç½® |
| PUT | /api/settings | ä¿å­˜æ¨¡å‹è®¾ç½® |
| DELETE | /api/settings/api-key/{provider} | æ¸…é™¤ API Key |
| GET | /api/export/pdf/{id} | å¯¼å‡º PDF |
| GET | /api/export/markdown/{id} | å¯¼å‡º Markdown |
